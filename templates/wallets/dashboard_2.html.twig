{% extends 'base.html.twig' %}

{% block page_title %}{{ 'Wallets'|trans|title }}{% endblock %}

{% block stylesheets %}
    {{ parent() }}

    {% include 'Components/Panel/panel-table-css.html.twig' %}

    <link rel="stylesheet" href="{{ asset('build/wallet_dashboard.css') }}">
{% endblock %}

{% block page_content %}

    {% include 'wallets/partial/head-dashboard-2.html.twig' %}
    {% include 'wallets/partial/operation-box-2.html.twig' %}

{% endblock %}

{% block javascripts %}
    {{ parent() }}

    {% include 'Components/Panel/panel-table-scripts.html.twig' %}
    {% include 'wallets/partial/operation-box-2-scripts.html.twig' %}

    <script type="text/javascript"  src="{{ asset('build/wallet_dashboard_2.js') }}"></script>

    <script>
        $(document).ready(function() {
            const walletId = "{{ wallet_id }}";

            const eventBus = window.eventBus;

            // Operation panel
            const entityTitle = "{{ operation.entity_name|lower|replace({' ': '_'}) }}";
            const entityName = "{{ operation.entity_name|trans|lower }}";

            const operationPanelTable = createOperationPanel(
                entityTitle,
                entityName,
                walletId
            );

            const createOperationButton = createButtonCreatOperation(
                entityTitle,
                entityName,
                walletId,
                operationPanelTable
            );

            operationPanelTable.addButton(createOperationButton);

            let panel = new WalletDashboard(
                walletId,
                operationPanelTable
            );

            panel.render();
            panel.load();

            // Tweak button toggle main menu to show/hide columns
            $('.sidebar-toggle').on(
                'click',
                function(e) {
                    let $button = $(e.currentTarget);

                    if ($button.data('toggle') === 'push-menu') {
                        panel.toggleExpanded();
                    }
                }
            );
        });
    </script>

{% endblock %}
